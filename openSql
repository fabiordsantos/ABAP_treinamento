
REPORT ZR0008.

*TABELAS TRANSPARENTES
TABLES ZT0001.

* TELA DE SELEÇÃO
PARAMETERS: P_TPMAT LIKE ZT0001-TPMAT OBLIGATORY,
            P_DENOM LIKE ZT0001-DENOM OBLIGATORY,
            P_INSERT RADIOBUTTON GROUP GR1,
            P_UPDATE RADIOBUTTON GROUP GR1,
            P_MODIFY RADIOBUTTON GROUP GR1,
            P_DELETE RADIOBUTTON GROUP GR1.

*INSERT
IF P_INSERT = 'X'.
  CLEAR ZT0001.
  ZT0001-TPMAT = P_TPMAT.
  ZT0001-DENOM = P_DENOM.
  INSERT ZT0001.

IF SY-SUBRC = 0.
  COMMIT WORK.
  MESSAGE 'Registro cadastro com sucesso' TYPE 'S'.
ELSE.
  ROLLBACK WORK.
  MESSAGE 'Erro no Cadastro' TYPE 'I'.
ENDIF.

*UPDATE

ELSEIF P_UPDATE = 'X'.

  UPDATE ZT0001
  SET DENOM = P_DENOM
  WHERE TPMAT = P_TPMAT.

IF SY-SUBRC = 0.
  COMMIT WORK.
  MESSAGE 'Registro Atualizado com sucesso' TYPE 'S'.
ELSE.
  ROLLBACK WORK.
  MESSAGE 'Erro na Atualização' TYPE 'I'.
ENDIF.

*MODIFY

ELSEIF P_MODIFY = 'X'.
  CLEAR ZT0001.
  ZT0001-TPMAT = P_TPMAT.
  ZT0001-DENOM = P_DENOM.
  MODIFY ZT0001.

IF SY-SUBRC = 0.
  COMMIT WORK.
  MESSAGE 'Processamento realizaso com sucesso' TYPE 'S'.
ELSE.
  ROLLBACK WORK.
  MESSAGE 'Erro no processamento' TYPE 'I'.
ENDIF.

*DELETE

DELETE FROM ZT0001 WHERE TPMAT = P_TPMAT.

IF SY-SUBRC = 0.
  COMMIT WORK.
  MESSAGE 'Registro Eliminado' TYPE 'S'.
ELSE.
  ROLLBACK WORK.
  MESSAGE 'Erro ao eliminar' TYPE 'I'.
ENDIF.

ENDIF.
